# Заголовок проверки запроса

Определение заголовка запроса

| Имя параметра | Ограничения | Пример                             | Описание                                                  |
| :------------ | :---------- | :--------------------------------- | :-------------------------------------------------------- |
| key           | Длина: 64   | ithujj3onrzbgw5t                   | Ключ партнера                                             |
| timestamp     | Длина: 32   | 1722586649000                      | Временная метка инициации запроса (единица: миллисекунды) |
| sign          | Длина: 32   | 9e0ccfe3915e94bcc5bf7dd51ad4e8d9   | Подпись секрета партнера                                  |
| clientSign    | Длина: 512  | 9e0ccfe3915e94bcc5bfbBsC5EUxV6 ... | Подпись RSA партнера                                      |

## Правила поля `sign`

1. Зарегистрируйте партнера и получите `key` и `secret`.
2. Разберите запрос. Отсортируйте тело JSON по возрастанию ASCII ключей в JSON и соедините строки dataStr=key1=value1&key2=value2&key3=value3&...
3. Сгенерируйте временную метку (единица: миллисекунды)
4. Зашифруйте и сгенерируйте sign: Исходный текст перед шифрованием: strToHash = Secret+dataStr+timestamp Выполните MD5-шифрование исходного текста strToHash для генерации sign.
Конкретный код - функция GenerateMD5Sign.
5. Поместите key, timestamp и sign в заголовок HTTP.

## Подробное объяснение алгоритма подписи `clientSign`

1. Получите параметры запроса и отформатируйте их для получения новой отформатированной строки.

2. Подпишите данные из шага 1 с помощью приватного ключа RSA и сохраните результат подписи в переменную.
Сгенерируйте строку подписи для следующего массива параметров: `user_id = 1 coin = eth address = 0x038B8E7406dED2Be112B6c7E4681Df5316957cad amount = 10.001 trade_id = 20220131012030274786`
Отсортируйте каждый ключ в массиве от a до z. Если первая буква одинакова, смотрите на вторую букву и так далее. После сортировки соедините все значения массива с символом амперсанда (&), например, в $dataString:
`address=0x038B8E7406dED2Be112B6c7E4681Df5316957cad&amount=10.001&coin=eth&trade_id=20220131012030274786&user_id=1`
Эта строка - соединенная строка.

3. Используйте приватный ключ для подписи данных с помощью RSA-MD5. Конкретный код в функции generate_md5_sign.

# Общая информация

| Название               | Тип       | Пример                             | Описание                                                     |
| :--------------------- | :-------- | :--------------------------------- | :----------------------------------------------------------- |
| Глобальный код статуса | integer   | 1                                  | 1 указывает на успех. Подробности в Глобальном коде статуса. |
| Сообщение              | string    | ok                                 | Возвращает текстовую информацию.                             |
| Данные                 | json      | {"OpenID":"HEX..."}                | Возвращает конкретное содержимое данных.                     |
| Время                  | timeStamp | 1722587274000                      | UTC время (без часового пояса, в миллисекундах).             |
| Подпись                | string    | 9e0ccfe3915e94bcc5bfbBsC5EUxV6 ... | Платформа использует RSA для подписи всех данных.            |

Подпись, возвращаемая платформой, - это результат шифрования данных ответа с помощью алгоритма RSA. Фронтенд должен проверить подпись по возвращенным данным. Подробности в функции func: 

pub fn verify_rsa_signature`