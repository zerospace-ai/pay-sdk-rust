# 요청 검증 헤더

요청 헤더 정의

| 매개변수 이름 | 제약 조건 | 예시                               | 설명                                |
| :------------ | :-------- | :--------------------------------- | :---------------------------------- |
| key           | 길이: 64  | ithujj3onrzbgw5t                   | 파트너 키                           |
| timestamp     | 길이: 32  | 1722586649000                      | 요청 시작 타임스탬프 (단위: 밀리초) |
| sign          | 길이: 32  | 9e0ccfe3915e94bcc5bf7dd51ad4e8d9   | 파트너 시크릿 서명                  |
| clientSign    | 길이: 512 | 9e0ccfe3915e94bcc5bfbBsC5EUxV6 ... | 파트너 RSA 서명                     |

## `sign` 필드 규칙

1. 파트너를 등록하고 `key`와 `secret`을 얻습니다.
2. 요청을 파싱합니다. JSON 본문을 JSON 키의 ASCII 오름차순으로 정렬하고 문자열 dataStr=key1=value1&key2=value2&key3=value3&... 을 연결합니다.
3. 타임스탬프를 생성합니다 (단위: 밀리초).
4. 암호화하여 sign을 생성합니다: 암호화 전 평문: strToHash = Secret+dataStr+timestamp. 평문 strToHash에 MD5 암호화를 수행하여 sign을 생성합니다.
특정 코드는 GenerateMD5Sign 함수입니다.
5. key, timestamp 및 sign을 HTTP 헤더에 배치합니다.

## `clientSign` 서명 알고리즘 상세 설명

1. 요청 매개변수를 가져와 형식화하여 새로운 형식화된 문자열을 얻습니다.

2. 1단계의 데이터를 RSA 개인 키로 서명하고 서명 결과를 변수에 저장합니다.
다음 매개변수 배열에 대한 서명 문자열 생성: `user_id = 1 coin = eth address = 0x038B8E7406dED2Be112B6c7E4681Df5316957cad amount = 10.001 trade_id = 20220131012030274786`
배열의 각 키를 a에서 z로 정렬합니다. 첫 글자가 같으면 두 번째 글자를 확인하는 식으로 합니다. 정렬 후 모든 배열 값을 앰퍼샌드(&) 문자로 연결합니다. 예를 들어 $dataString에서:
`address=0x038B8E7406dED2Be112B6c7E4681Df5316957cad&amount=10.001&coin=eth&trade_id=20220131012030274786&user_id=1`
이 문자열이 연결된 문자열입니다.

3. 개인 키를 사용하여 RSA-MD5로 데이터를 서명합니다. 특정 코드는 generate_md5_sign 함수에 있습니다.

# 공개 정보

| 이름             | 유형      | 예시                               | 설명                                                                |
| :--------------- | :-------- | :--------------------------------- | :------------------------------------------------------------------ |
| 글로벌 상태 코드 | integer   | 1                                  | 1은 성공을 나타냅니다. 자세한 내용은 글로벌 상태 코드를 참조하세요. |
| 메시지           | string    | ok                                 | 텍스트 정보를 반환합니다.                                           |
| 데이터           | json      | {"OpenID":"HEX..."}                | 특정 데이터 내용을 반환합니다.                                      |
| 시간             | timeStamp | 1722587274000                      | UTC 시간 (시간대 없음, 밀리초 단위).                                |
| 서명             | string    | 9e0ccfe3915e94bcc5bfbBsC5EUxV6 ... | 플랫폼은 RSA를 사용하여 모든 데이터를 서명합니다.                   |

플랫폼에서 반환된 Sign은 RSA 알고리즘을 사용하여 응답 데이터를 암호화한 결과입니다. 프론트엔드는 반환된 데이터에 대해 서명을 검증해야 합니다. 자세한 내용은 함수 func: 

pub fn verify_rsa_signature`를 참조하세요.